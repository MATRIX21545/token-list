<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Moja dApp BEP-20</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        #tokenList { margin-top: 20px; }
        .token { display: flex; align-items: center; margin-bottom: 10px; }
        .token img { width: 32px; height: 32px; margin-right: 10px; }
    </style>
</head>
<body>
    <h1>Moja dApp BEP-20</h1>
    <button id="connectButton">Połącz MetaMask</button>
    <input type="text" id="searchInput" placeholder="Szukaj tokena..." />
    <div id="tokenList"></div>

    <script>
        const connectButton = document.getElementById("connectButton");
        const searchInput = document.getElementById("searchInput");
        const tokenListDiv = document.getElementById("tokenList");

        const tokenListUrl = "https://matrix21545.github.io/token-list/tokenlist.json"; //
        let tokens = [];

        connectButton.addEventListener("click", async () => {
            if (window.ethereum) {
                try {
                    const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
                    console.log("Połączono z kontem:", accounts[0]);
                    loadTokens();
                } catch (error) {
                    console.error(error);
                    alert("Błąd połączenia z MetaMask");
                }
            } else {
                alert("MetaMask nie wykryty! Użyj Chrome/Brave/Edge z MetaMask.");
            }
        });

        async function loadTokens() {
            try {
                const response = await fetch(tokenListUrl);
                const data = await response.json();
                tokens = data.tokens; // zakładam, że tokeny są w polu "tokens"
                displayTokens(tokens);
            } catch (error) {
                console.error("Błąd wczytywania tokenów:", error);
            }
        }

        function displayTokens(list) {
            tokenListDiv.innerHTML = "";
            list.forEach(token => {
                const div = document.createElement("div");
                div.className = "token";
                div.innerHTML = `
                    <img src="${token.logoURI}" alt="${token.symbol}" />
                    <span>${token.name} (${token.symbol})</span>
                `;
                tokenListDiv.appendChild(div);
            });
        }

        searchInput.addEventListener("input", () => {
            const query = searchInput.value.toLowerCase();
            const filtered = tokens.filter(t => t.name.toLowerCase().includes(query) || t.symbol.toLowerCase().includes(query));
            displayTokens(filtered);
        });
    </script>
</body>
</html>

